<html>
	<head>
		<title>chatroom</title>
  	 		<script src="/socket.io/socket.io.js"></script>
   			<script src="/static/jQuery/jquery-2.1.4.min.js"></script>
	</head>

	<body>
		<input type="text" name="message" id="text">
		<input type="button" value="send" id="sendtext">
		<div id="date"></div>
		<div class="msgs">
			
		</div>
	</body>
</html>

<script>
	var socket = io('http://localhost:3000');
	var now = new Date().getFullYear().toString()+"-"+new Date().getMonth().toString()+"-"+new Date().getDate().toString()+" "+new Date().getHours().toString()+":"+new Date().getMinutes().toString()+":"+new Date().getSeconds().toString();
	var username;
	var nickname;
	socket.on("who",function(){
		username=prompt("username:");
		socket.emit('userusername',username);
	});

	socket.on('nou',function(){
		username=prompt("username:");
		socket.emit('userusername',username);
	});

	socket.on('inp',function(){
		var pass=prompt("password:");
		socket.emit('userpass',username,pass);
	});

	socket.on('wp',function(){
		var pass=prompt("password:");
		socket.emit('userpass',username,pass);
	})

	socket.on('rp',function(nick){
		nickname=nick;
		socket.emit('sendchat', nickname+" join the chat", "Server");
	})

	window.addEventListener('load',function() { 
	    document.getElementById('sendtext').addEventListener('click',function() {
	        var text = document.getElementById('text').value; 
 	       	socket.emit('sendchat', text, nickname);
 	       	document.getElementById('text').value="";
 	   }, false); 
	}, false);

	socket.on("pubchat",function(text ,sendname ,time){
		//give text to html
		console.log(text,sendname);
		var date=new Date().getFullYear().toString()+"-"+new Date().getMonth().toString()+"-"+new Date().getDate().toString()+" "+new Date().getHours().toString()+":"+new Date().getMinutes().toString()+":"+new Date().getSeconds().toString();
		$('.msgs').append("<p>"+sendname+" : "+text+'</p>'+'<p style="text-align:right">'
							   +date+'</p>');
	});

	socket.on('now', function(data) {
        $('#date').text(data.date);
    });

</script>