<html>
	<head>
		<title>chatroom</title>
  	 		<script src="/socket.io/socket.io.js"></script>
   			<script src="/static/jQuery/jquery-2.1.4.min.js"></script>
	</head>

	<body>
		<div id="chatarea">

		</div>
		<div id="loginarea">

		</div>
		<div id="wrn" style="color:red;font-size:20px">
			
		</div>

		<div id="date"></div>
		<div class="msgs">

			
		</div>
	</body>
</html>

<script>
	var socket = io('http://localhost:3000');
	var now = new Date().getFullYear().toString()+"-"+new Date().getMonth().toString()+"-"+new Date().getDate().toString()+" "+new Date().getHours().toString()+":"+new Date().getMinutes().toString()+":"+new Date().getSeconds().toString();
	var username;
	var nickname;
	socket.on("who",function(){
		$('#loginarea').append('<input type="text" name="username" id="username"><br><input type="password" name="pass" id="pass"><br><input type="button" id="login" value="login">');
	});

	socket.on('nou',function(){
		$('#wrn').text('unknown username');
		document.getElementById('username').value="";
		document.getElementById('pass').value="";
	});

	socket.on('logindone',function(){
		$('#loginarea').remove();
		$('#chatarea').append('<input type="text" name="message" id="text"><input type="button" value="send" id="sendtext">');
		$('#wrn').text('');
	})

	$('#sendtext').click(function(){
		var text = document.getElementById('text').value; 
 	  	socket.emit('sendchat', text, nickname);
      	document.getElementById('text').value="";
	});

	$('#login').click(function(){
		console.log("in");
		var username = document.getElementById('username').value; 
	    var pass = document.getElementById('pass').value;
 	    socket.emit('loginq',username,pass);
 	    document.getElementById('pass').value="";
 	});

/*	window.addEventListener('load',function() { 
	    document.getElementById('sendtext').addEventListener('click',function() {
 	   }, false); 
	}, false);*/

/*	window.addEventListener('load',function() { 
	    document.getElementById('login').addEventListener('click',function() {
	    	console.log("dec")

 	   }, false); 
	}, false);*/

	socket.on("pubchat",function(text ,sendname ,time){
		//give text to html
		console.log(text,sendname);
		var date=new Date().getFullYear().toString()+"-"+new Date().getMonth().toString()+"-"+new Date().getDate().toString()+" "+new Date().getHours().toString()+":"+new Date().getMinutes().toString()+":"+new Date().getSeconds().toString();
		$('.msgs').append("<p>"+sendname+" : "+text+'</p>'+'<p style="text-align:right">'
							   +date+'</p>');
	});

	socket.on('now', function(data) {
        $('#date').text(data.date);
    });

</script>